#!/bin/bash

# mv notification file to a new location and process the current
# list of notificates since the last time that we ran.
# The mv command has been selected as it is assumed that it
# can be used atomically
new_file=/tmp/`basename /usr/lib/jiocloud/metrics/collectd_notifications.log``date +%Y%m%d%H%M%S`
FILE="/usr/lib/jiocloud/metrics/collectd_notifications.log"
if [ -f $FILE ];
then
sudo mv $FILE $new_file

python /usr/lib/jiocloud/metrics/check_thresholds.py --filename $new_file --servicename <%= @name %>

fi
